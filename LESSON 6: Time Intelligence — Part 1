LESSON 6: Time Intelligence â€” Part 1
(DATEADD, SAMEPERIODLASTYEAR, PREVIOUSMONTH, LASTN Periods)

DATEADD(-3 MONTH) â†’ only the month exactly 3 months back (e.g., April â†’ January)

DATESINPERIOD(-3 MONTH) â†’ last 3 months window combined (e.g., Apr+Mar+Feb)

Rolling_3_Months =
CALCULATE(
    [Total Sales],
    DATESINPERIOD(
        'Date'[Date],
        MAX('Date'[Date]),   -- current date context (April)
        -3,
        MONTH
    )
)

ðŸŸ¦ 1. DATEADD â€” The Core of Time Intelligence

DATEADD shifts dates forward/backward in a date column.

Syntax:
DATEADD(Date[Date], -1, YEAR)
DATEADD(Date[Date], -1, MONTH)
DATEADD(Date[Date], -3, MONTH)
DATEADD(Date[Date], -1, QUARTER)

ðŸŸ© 2. Sales Last Year (YoY)
Sales_Last_Year =
CALCULATE(
    [Total Sales],
    DATEADD('Date'[Date], -1, YEAR)
)

Explanation:

DATEADD shifts the entire date context 1 year back

CALCULATE returns sales for shifted dates

ðŸŸ§ 3. Sales for Previous Month
Sales_Previous_Month =
CALCULATE(
    [Total Sales],
    DATEADD('Date'[Date], -1, MONTH)
)

Example:

If the current context is March 2024
DATEADD â†’ shifts to February 2024

ðŸŸª 4. Sales for Last 3 Months (Rolling 3 Months)
Sales_Last_3_Months =
CALCULATE(
    [Total Sales],
    DATEADD('Date'[Date], -3, MONTH)
)


Important:
This shifts the window back 3 months, not sum of 3 individual months (that is rolling).

If you want rolling 3 months (current + last 2 months):

Rolling_3_Months =
CALCULATE(
    [Total Sales],
    DATESINPERIOD('Date'[Date], MAX('Date'[Date]), -3, MONTH)
)

ðŸŸ¥ 5. Sales for Previous Quarter
Sales_Previous_Quarter =
CALCULATE(
    [Total Sales],
    DATEADD('Date'[Date], -1, QUARTER)
)

ðŸŸ¨ 6. Sales for Current Year but Excluding Current Month

Very common interview question.

Sales_YTD_Excluding_Current_Month =
CALCULATE(
    [Total Sales],
    FILTER(
        ALL('Date'),
        'Date'[Year] = YEAR(TODAY())
            && 'Date'[Month] < MONTH(TODAY())
    )
)

What this does:

ALL('Date') â†’ remove all date filters

Filter only dates:

year = current year

month < current month

ðŸŸ« 7. SAMEPERIODLASTYEAR (Alternative YoY)
Sales_LY =
CALCULATE(
    [Total Sales],
    SAMEPERIODLASTYEAR('Date'[Date])
)


Same output as DATEADD(-1 YEAR).

ðŸŸ© 8. PREVIOUSMONTH Shortcut
Sales_PM =
CALCULATE(
    [Total Sales],
    PREVIOUSMONTH('Date'[Date])
)

â­ At This Stage You Should Know:

âœ” DATEADD shifts dates
âœ” PREVIOUSMONTH, SAMEPERIODLASTYEAR are shortcuts
âœ” DATESINPERIOD creates rolling windows
âœ” FILTER+ALL can create custom time intelligence

Practice questions:
1. Sales for the same month last year.
measure = calculate(sum(sales[amount]),dateadd(datetable[date] , -1, year))

2. Sales for the immediately previous month.
measure = calculate(sum(sales[amount]), dateadd(datetable[date], -1, month))

3. Sales for the quarter immediately before the current quarter.
measure = calculate(sum(sales[amount]), dateadd(datetable[date], -1, quarter))

4. Sales Last 3 Months
measure = calculate(sum(sales[amount]), DATESINPERIOD(datetable[Date], MAX(datetable[Date]), -3, MONTH))

5. Rolling 6 Months Sales
measure = calculate(sum(sales[amount]), datesinperiod(datetable[date], max(datetable[date]), -6, month))

6. Sales from Jan 1 of the current year up to today
Sales_YTD = totalytd(sum(sales[amount]), datetable[date])

7. YTD Sales but remove current monthâ€™s sales.
Sales_YTD_Excluding_Current_Month =
CALCULATE(
    [Sales_YTD],
    FILTER(
        ALL(DateTable),
        DateTable[Year] = YEAR(TODAY()) &&
        DateTable[MonthNumber] < MONTH(TODAY())
    )
)

8. Difference = Sales This Quarter â€“ Sales Previous Quarter
tq = calculate(sum(sales[amount]), DATESQtd(datetable[Date])
pq = calculate(sum(sales[amount]), dateadd(datetable[Date], -1, quarter))
measure  = [tq] - [pq]

9. % Growth from Last Year
ty = calculate(sum(sales[amount]))
ly = calculate(sum(sales[amount]), dateadd(datetable[date] , -1, year))
measure = divide([ty] - [ly], [ly])

10. Compute number of active customers in last 90 days.
calculate(distinctcount(sales[customer_id]), datesinperiod(datetable[date], max(datetable[date], -90, day)))
